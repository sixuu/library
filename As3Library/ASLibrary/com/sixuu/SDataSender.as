package  com.sixuu{	import flash.net.NetConnection;	import flash.net.NetGroup;	import flash.events.NetStatusEvent;	import flash.net.GroupSpecifier;	public class SDataSender	{		public var onReceiveData:Function;		private var nc:NetConnection;		private var group:NetGroup		private var broadcastStr		private var publishKey		public function SDataSender()		{		}		public function init(_broadcastStr:String="224.213.0.0",publishkey="uuConn")		{			this.publishKey=publishkey			this.broadcastStr=_broadcastStr			nc=new NetConnection();			nc.connect("rtmfp:");			nc.addEventListener(NetStatusEvent.NET_STATUS,ncHandler);		}		public function sendData(obj:Object,failFunction:Function=null)		{			if (group!=null)			{				group.sendToAllNeighbors(obj);							}else{				failFunction!=null?failFunction():0			}		}		private function ncHandler(e:NetStatusEvent)		{  		    			switch (e.info.code)			{				case "NetConnection.Connect.Success" :					setupGroup();					break;				case "NetGroup.Connect.Sucess" :					break;				case "NetGroup.SendTo.Notify" :				    onReceiveData(e.info.message)				break			}		}		private function setupGroup()		{			var groupspec:GroupSpecifier = new GroupSpecifier(publishKey);			groupspec.routingEnabled = true;			groupspec.ipMulticastMemberUpdatesEnabled = true;			groupspec.addIPMulticastAddress(broadcastStr,3999);			groupspec.multicastEnabled = true;			group = new NetGroup(nc,groupspec.groupspecWithAuthorizations());			group.addEventListener(NetStatusEvent.NET_STATUS,ncHandler);		}	}}